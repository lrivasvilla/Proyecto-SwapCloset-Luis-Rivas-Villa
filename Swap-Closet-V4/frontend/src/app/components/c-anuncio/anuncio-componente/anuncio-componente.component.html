<div class="producto-card">
  <ion-grid>
    <ion-row>
      <div class="imagen-container">
        <ion-img
          [src]="primeraImagen"
          alt="Imagen del producto"
          class="producto-imagen"
        ></ion-img>

        <ion-chip
          [ngClass]="(producto?.tipo | lowercase ) === 'intercambio' ? 'chip-rosa' : 'chip-azul'"
          class="chip-intercambio"
        >
          <b>{{ producto?.tipo }}</b>
        </ion-chip>
      </div>
    </ion-row>

    <ion-row>
      <div class="info-container">
        <h2 class="producto-titulo">{{ producto?.titulo }}</h2>
        <p class="producto-descripcion">{{ producto?.descripcion }}</p>

        <div class="chip-group">
          <ion-chip
            *ngFor="let est of estilos"
            [ngClass]="(producto?.tipo | lowercase) === 'intercambio' ? 'chip-rosa' : 'chip-azul'"
          >
            <b>{{ est }}</b>
          </ion-chip>
        </div>

        <ion-row>
          <ion-col>
            <div class="detalle-item">
              <span class="detalle-label">Categoría</span>
              <span class="detalle-valor">{{ producto?.categoria }}</span>
            </div>
          </ion-col>
        </ion-row>

        <div class="detalles-section">
          <ion-row>
            <ion-col>
              <div class="detalle-item">
                <span class="detalle-label">Talla</span>
                <span class="detalle-valor">{{ producto?.talla }}</span>
              </div>
            </ion-col>
            <ion-col>
              <div class="detalle-item">
                <span class="detalle-label">Estado</span>
                <span class="detalle-valor">{{ producto?.estado }}</span>
              </div>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <div class="detalle-item">
                <span class="detalle-label">Marca</span>
                <span class="detalle-valor">{{ producto?.marca }}</span>
              </div>
            </ion-col>
            <ion-col>
              <div class="detalle-item">
                <span class="detalle-label">Color</span>
                <span class="detalle-valor">{{ producto?.color }}</span>
              </div>
            </ion-col>
          </ion-row>
        </div>

        <div class="fecha-section">
          <ion-icon class="icon" name="location-sharp"></ion-icon>
          <p class="fecha-texto">Ubicación: </p>
          <p class="fecha-date margen-left"><b>{{usuario?.direccion}}</b></p>
        </div>

        <ng-container *ngIf="(producto?.tipo | lowercase )!== 'intercambio'">
          <div class="fecha-section">
            <ion-icon class="icon" name="cash-sharp"></ion-icon>
            <p class="fecha-texto">Precio por día: </p>
            <p class="fecha-date margen-left"><strong>{{ producto?.precio }} €</strong></p>
          </div>
        </ng-container>

        <div class="fecha-section">
          <ion-icon name="calendar-sharp" class="icon"></ion-icon>
          <p class="fecha-texto">Disponible hasta el: </p>
          <p> </p>
          <p class="fecha-date margen-left"><strong> {{ producto?.fechaDevolucion | date:'dd/MM/yyyy'  }}</strong></p>
        </div>

        <!-- Sección del usuario con clases nuevas -->
        <div class="usuario-card-container">

          <!-- Fila superior: Avatar a la izquierda + Nombre y rating al lado -->
          <ion-row class="usuario-card-top-row">
            <div size="3" class="usuario-card-avatar-col">
              <ion-img [src]="usuario?.urlImg" class="usuario-card-avatar"></ion-img>
            </div>

            <div class="usuario-card-info-col">
              <h2 class="usuario-card-nombre">{{ usuario?.nombre }} {{ usuario?.apellidos }}</h2>

              <div class="usuario-card-rating">
                <span class="usuario-card-rating-num">{{ usuario?.raiting }}</span>
                <ion-icon class="usuario-card-star" name="star"></ion-icon>
                <span class="usuario-card-separador">·</span>
                <span class="usuario-card-intercambios">{{ usuario?.intercambios }} intercambios</span>
              </div>
            </div>

          </ion-row>

          <!-- Fila inferior: Botón Ver perfil centrado -->
          <ion-row class="usuario-card-bottom-row">
            <ion-col class="usuario-card-button-col">
              @if (usuario?.id !== idUsuarioLogueado) {
                <ion-button fill="clear" class="usuario-card-btn-perfil" [routerLink]="['/perfil-otro', usuario?.id]">
                  Ver perfil
                </ion-button>
              } @else {
                <ion-button fill="clear" class="usuario-card-btn-perfil" [routerLink]="['/perfil']">
                  Ver perfil
                </ion-button>
              }
            </ion-col>
          </ion-row>

        </div>

      </div>
    </ion-row>
  </ion-grid>
</div>
